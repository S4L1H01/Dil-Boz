<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dil-Boz | Kaos Lobisi</title>
    <style>
        :root { --discord-blue: #7289da; --dark-bg: #2c2f33; --panel-bg: #23272a; }
        body { background: var(--dark-bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; }
        
        /* LOBÄ° TASARIMI */
        .screen { display: none; flex-direction: column; align-items: center; justify-content: center; height: 100vh; width: 100vw; }
        .active { display: flex; }
        
        .panel { background: var(--panel-bg); padding: 30px; border-radius: 20px; border: 2px solid var(--discord-blue); width: 90%; max-width: 600px; text-align: center; position: relative; }
        
        /* OVAL LÄ°NK KUTUSU */
        .link-box { background: #40444b; border-radius: 50px; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; margin: 15px 0; border: 1px solid #5865f2; }
        .link-box span { font-size: 0.8rem; color: #b9bbbe; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 70%; }
        
        /* SÃœRÃœKLENEBÄ°LÄ°R BALONCUKLAR */
        #lobby-area { width: 100%; height: 200px; background: #2f3136; border-radius: 15px; position: relative; overflow: hidden; margin: 15px 0; }
        .player-bubble { 
            position: absolute; padding: 10px 20px; background: var(--discord-blue); 
            border-radius: 50px; cursor: move; font-weight: bold; user-select: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); transition: transform 0.1s;
        }

        /* OYUN ALANI */
        .word-display { background: #4f545c; padding: 25px; border-radius: 15px; font-size: 1.8rem; color: #faa61a; margin: 20px 0; min-height: 60px; }
        input, select { background: #40444b; color: white; border: none; padding: 12px; border-radius: 8px; margin: 10px; width: 70%; }
        button { background: var(--discord-blue); color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        button:hover { filter: brightness(1.2); }
    </style>
</head>
<body>

    <div id="menu-screen" class="screen active">
        <div class="panel">
            <h1>Dil-Boz ðŸŒ€</h1>
            <input type="text" id="player-name" placeholder="Nickini Yaz...">
            <div style="margin: 10px;">
                <label>Tur SayÄ±sÄ±:</label>
                <select id="max-turns">
                    <option value="3">3 Tur (HÄ±zlÄ±)</option>
                    <option value="5">5 Tur (Normal)</option>
                    <option value="10" selected>10 Tur (Tam Kaos)</option>
                </select>
            </div>
            <button onclick="joinLobby()">Lobiye KatÄ±l</button>
        </div>
    </div>

    <div id="lobby-screen" class="screen">
        <div class="panel">
            <h2>Oyuncu Lobisi</h2>
            <div class="link-box">
                <span id="invite-url">yÃ¼kleniyor...</span>
                <button onclick="copyLink()" style="padding: 5px 15px; font-size: 0.7rem;">Kopyala</button>
            </div>
            <div id="lobby-area">
                </div>
            <p id="player-count">KatÄ±lan: 0 KiÅŸi</p>
            <button id="start-btn" onclick="goToGame()" style="background: #43b581;">Oyunu BaÅŸlat âž”</button>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div class="panel">
            <h3 id="current-player-display">---</h3>
            <div class="word-display" id="display-text">---</div>
            <input type="text" id="game-input" placeholder="AnladÄ±ÄŸÄ±nÄ± yaz...">
            <button onclick="submitTurn()">GÃ¶nder</button>
        </div>
    </div>

    <script>
        let players = [];
        let config = { turns: 10, currentTurn: 0 };
        let history = [];
        
        // HARF BOZMA SÃ–ZLÃœÄžÃœ (Ä°stediÄŸin benzer karakterler)
        const charMap = {
            'a': 'Î±', 'e': 'â‚¬', 'i': 'Ä±', 'Ä±': 'i', 'u': 'Î¼', 'Ã¼': 'Ï‹', 
            'o': '0', 'Ã¶': 'Î¸', 's': 'Â§', 'ÅŸ': 'âˆ«', 'g': '9', 'ÄŸ': 'Äž'
        };

        // LÄ°NK AYARI
        document.getElementById('invite-url').innerText = window.location.href;

        function joinLobby() {
            let nick = document.getElementById('player-name').value;
            if(!nick) return alert("Nick yazmalÄ±sÄ±n!");
            players.push(nick);
            createBubble(nick);
            showScreen('lobby-screen');
            document.getElementById('player-count').innerText = "KatÄ±lan: " + players.length + " KiÅŸi";
        }

        function createBubble(name) {
            const b = document.createElement('div');
            b.className = 'player-bubble';
            b.innerText = name;
            b.style.left = Math.random() * 200 + 'px';
            b.style.top = Math.random() * 100 + 'px';
            
            // SÃœRÃœKLEME MANTIÄžI
            let isDragging = false;
            b.onmousedown = (e) => { isDragging = true; };
            window.onmousemove = (e) => {
                if(!isDragging) return;
                b.style.left = e.pageX - b.offsetWidth/2 + 'px';
                b.style.top = e.pageY - b.offsetHeight/2 + 'px';
            };
            window.onmouseup = () => isDragging = false;
            
            document.getElementById('lobby-area').appendChild(b);
        }

        function goToGame() {
            config.turns = document.getElementById('max-turns').value;
            showScreen('game-screen');
            startTurn();
        }

        function startTurn() {
            let pName = players[config.currentTurn % players.length];
            document.getElementById('current-player-display').innerText = "SÄ±ra Sende: " + pName;
            if(config.currentTurn === 0) {
                document.getElementById('display-text').innerText = "OYUNU BAÅžLATMAK Ä°Ã‡Ä°N BÄ°R CÃœMLE YAZIN!";
            }
        }

        function submitTurn() {
            let val = document.getElementById('game-input').value;
            if(!val) return;
            
            history.push(val);
            config.currentTurn++;

            if(config.currentTurn >= config.turns) {
                alert("Oyun Bitti! SonuÃ§lar konsolda (GeliÅŸtirilecek)");
                location.reload();
            } else {
                document.getElementById('display-text').innerText = corruptText(val);
                document.getElementById('game-input').value = "";
                startTurn();
            }
        }

        function corruptText(text) {
            return text.split('').map(char => {
                let lower = char.toLowerCase();
                if(charMap[lower] && Math.random() > 0.6) {
                    return charMap[lower];
                }
                return char;
            }).join('');
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href);
            alert("Link kopyalandÄ±! ArkadaÅŸlarÄ±na gÃ¶nder.");
        }
    </script>
</body>
</html>